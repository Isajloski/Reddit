# 1. Вовед

RedBot претставува форум портал испириран од Reddit и Quora. Има за цел да креира простор во кој корисниците ќе можат да разменуваат информации и да комуницираат помеѓу себe. 

RedBot претставува апликација која ќе го олесни начинот на комуникација и размена на информации. Апликацијата ќе биде достапна на сите корисници и истите ќе имаат пристап до информациите во зависност од нивото за кое се авторизирани. Корисниците ќе имаат опција за создавање на нови заедници, со свои правила и тема. Корисниците ќе имаат опција за да креираат нови објави во некои од заедниците. Секој корисник ќе може да објавува објави и да коментира на други постови, исто така корисникот ќе може да лајкнува и дислајкнува постови и коментари. Со едноставен и лесен кориснички интерфејс се гарантира успешноста за користење на нашата апликација. 

Следните секции ќе пробаат да ги објаснат сите фунцкионалности на RedBot, како може да правите промени, како може да го користите кодот и што ви е потребно за истото.

# 2. Функционални и нефунцкионални барања

## 2.1 Функционални барањња

### Корисник
- Регистрација на корисник
- Пријава на корисник
- Уредување на корисничките информации
- Следење на community
- Преглед на сите објави во едно community или на home page.
- Преглед на сите коментари. 
- Креирање на пост за одредено community
  - Додавање на пост
  - Бришење на пост
  - Ажурирање на пост 
- Коментирање на објави
  - Додавање на пост
  - Бришење на пост
  - Ажурирање на пост 
- Преглед на сите објави и коментари

### Модератор
- Ажурирање на communitiy 
- Бришење на community
- Бришење на други објави од други корисници.
- Бришење на коментари од други корисници.

## 2.2 Нефункциски барања

### Барања за перформанси
- Системот треба да поддржува 50000 + корисници во даден момент.
- Содржината на страните на системот мора да се вчита за најмногу 3 секунди.
- Системот мора да поддржува скалабилност.
- Системот треба да биде компатибилен со други системи.
- Базата на податоци на системот треба да има минимална големина од 100TB.
- Кога системот ќе биде под тежок товар, времето на одговор не смее да биде повеќе од 5
секунди.
- При пад на системот, тој мора да биде онлајн за помалку од 40 минути.

### Барања за безбедност и приватност

- Мрежниот сообраќај да се одвива преку HTTPS.
- Користење на безбедни бази за чување на податоците и соодветен backup на податоците на друга локација.
- При најава на самиот систем да се валидира корисникот преку соодветниот е-маил внесен
при извршената регистрација на корисникот.
- Системот треба да е доверлив при DOS напади.
- При прикачување на некаква содржина од страна на студентот, системот мора да обезбеди
интегритет на тие податоци.
- За секое прикачување или ажурирање на постоечката содржина, корисникот мора да се
логира на системот.
- При обид за најавување на туѓа корисничка сметка, системот треба да ја блокира таа сметка.
- Заштита на лозинката и личните податоци на корисникот, како и пораките испратени кон
останатите корисници.

### Барање за Кориснички Интерфејс
- Корисничкиот интерфејс треба да биде интуитивен и лесен за користење за сите видови на корисници.
- Системот треба да биде брз и одзивен на сите видови на уреди, вклучително мобилни телефони и таблети.
- Поддршка за Мобилни Уреди: Системот треба да се прилагоди и биде функционален на различни мобилни оперативни системи.
- Поддршка за Различни Јазици: Системот треба да обезбеди поддршка за различни јазици, вклучително поддршка за Unicode.
- Локални Формати на Датуми и Време: Прикажувањето на датуми и време кои ќе се прилагодат, врз основа на моменталната локација на коринисникот.


# 3. Дизајн
За целосна реимплементација направен е и редизајн на корисничкиот интерфејс.
Целта е да се намали комплексноста, да изгледа модерно и атрактивно, истовремено и едноставно.

## 3.1 Редизајн на лого

![Redbot logo](https://i.ibb.co/GCV7hLZ/redbot-horizontal-01-1.png)
Логото е директно инспирирано од моменталното лого на редит, и е симплифицирана илустрација на робот со цел да се задржи тековниот бренд и идентитет на редит.

## 3.2 Редизајн на страници
![Home Page](https://i.ibb.co/rmCHDBH/homepage.png)
Страната е поделена во три секции, каде што објавите се листаат во средина за да го задржат целосниот фокус, додека пак левата и десната страна служат за додатни функционалности како филтрирање и правење акции.
На секоја објава има можност да се види авторот, која е заедницата, содржината на објавата, датум, како и број на интеракции.

[Figma project](https://www.figma.com/file/Zy4PBjqQ4Kqmmd3VMhMfGc/Reddit?type=design&node-id=0%3A1&mode=design&t=67Rht0nqNYy1Aq9F-1)



# 4. Технологии 

При развој на RedBot, ние избравме стак од модерни и ефикасни технологии кои ни овозможуваат голем број на функионалности, подобри перформанси и поубави визуелни ефекти. Подоле, ќе ги опишеме овие технологии и нивните карактеиристики.

## 4.1 Laravel

Laravel е моќен и широко користен PHP веб фрејмворк познат по неговата елегантна синтакса. Laravel како архитектура ја користи MVC (Mode View Controller), со која ни се поедноставува логиката на самата апликација.

Laravel's ORM (Object-Relational Mapping) provides an intuitive way to interact with databases, reducing the complexity of SQL queries.
Eloquent simplifies database operations and allows developers to work with database records as PHP objects.

### Карактеристики на Laravel:
- Eloquent ORM
    - ORM или Object-Relational Mapping ни овозможува лесна и ефикасна работа со податочни бази, исто така ја намалува комплексноста на SQL прашалниците.
    - Eloquent му овозможува на корисникот да работи со податоци од податочната база како готови PHP објекти, со што многу се олеснува развојот на софтвер. 
- Artisan CLI
    - Artisian е command line interface кој се користи при работа со датабази, генерирање на готови класи и методи во соодветни фолдери. 
- Authentication and Authorization
    - Laravel веќе има имплементирано Автентикација и авторизизација, исто така овозможува контрола на рутите преку некакви улоги.
    - Со пишување на една линија код во Artiain CLI корисникот ќе има веќе готова авторизација и автентикација, која пдоцоцна може да ја прошири, во зависност од потребите.
- Middleware
    - Се користат при филтирање на барања, како што се авторизација и автентикација, филтрирање на барања и внесени податоци.
- RESTful Routing
    - Laravel го поедноставува процесот на рутирање. и работа со кориснички и надворешни барања.

## 4.2 Vue

Vue.js is a progressive JavaScript framework designed for building user interfaces.

Vue.js е JavaScript фрејмвор кој е дизајниран за креирање на кориснички интерфејси. Нуди копонентно базирана архитектура (component-based arhitecture), оваа архитектура ни овозможува да го реискористуваме.


### Карактеристики на Vue

- Reactivity
    - Vue користи двосмерно поврзување на податоците (two-way data binding) и реактивни процеси кои ни овозмужуваат промена на податоците во реално време.
    - Vue исто така овозможува манипулација со податоците, без директно манипулирање на Dom елементите.
- Components
    - Vue ги енкапсулира UI елементите, логиката и стиловите, ова доведува до реискористување на кодот.
    - Девелоперите може да создаваат многу коплекси интерфесји користејќи ситни копоненти.
- Directives
    - Преставуваат специјални HTML елементи кои ни овозможуваат директна работа со DOM елементите. 
    - Примери за directives се: v-if, v-else, v-for, v-model и други.
- Vue Router:
    - Ни овозможува рендерирање на клиенкста страна, што ни овозможува да креираме single-page aplication(SPA).
    - Ни овозможува течна навигација низ апликацијата.
- State Menagment
    - Vuex е офијцална библиотека која се користи при state menagment. 
    - Сигурно и ефикасно го 
    



# 5. Податочна база и миграции

Во Laravel, миграциите претставуваат едноставен начин на управување со податочни структури. Тие ни дозволуваат да ја структурираме и организираме податочната база во нашата веб апликација. Laravel кориси ojbect-oriented начин за дефинирање на податочната база, тоа зчани дека без разлика каков податочен систем користиме на пример MySQL, PosgresSQL, SQLite или Manjaro, миграциите ќе работат секаде исто. 

Миграциите се PHP датотеки лоцирани во `/database/migrations` фолдерот во Laravel проектот. Секоја миграција претставува своја податочна шема, исто така дозволува бришење, промена на самите табели.

Laravel користи Object-Relational Mapping (ORM) исто така наречен Eloquent со кој комуницираме со базата. Eloquent ни дозволува работа со миграциите, креирање на квериња со што ни се олеснува работата.  



## Конфикурација и конекција со податочна база 

Laravel го прави конектирањето и работењето со податочни бази многу едноставен процес. Фајлот за конфигурација се наоѓа на `/app/config/database.php`. Во овој фајл ние може да ги дефинираме сите конекции, како и кои конекција.

Некогаш сакаме да направиме читање од една база, бришење во друга и обновување во трета. 


Пример:


``` php
'mysql' => array(
    'read' => array(
        'host' => '192.168.1.1',
    ),
    'write' => array(
        'host' => '196.168.1.2'
    ),
    'driver'    => 'mysql',
    'database'  => 'database',
    'username'  => 'root',
    'password'  => '',
    'charset'   => 'utf8',
    'collation' => 'utf8_unicode_ci',
    'prefix'    => '',
),
```


Доколку не сакаме да дефинираме се, Laravel дозволува да се конектираме до податочната база преку `.env` во која веќе имаме предефинирани конфигуразии за конекција со некоја база. `/config/database.php`, ова се користи доколку сакаме да дефинираме повеќе податочни бази и да правиме подетални променни на конфигурацијат.

Доколку сакате да направите промена на податочната од еден во друг тип, тоа може да го сторите на слендиот начин:

```php
DB_CONNECTION=
DB_HOST=
DB_PORT=
DB_DATABASE=
DB_USERNAME=
DB_PASSWORD=
```

Во овој дел од .env може да ја направите измената. 


Пример за SQLite:

```php 
DB_CONNECTION=sqlite
DB_HOST=null
DB=DATABASE=/абсолутнаПатека
DB_PORT=null
DB_USERNAME=null
DB_PASSWORD=null
```

Пример за PosgresSQL:

``` php
DB_CONNECTION=pgsql
DB_HOST=localhost
DB_PORT=5432
DB_DATABASE=mydatabase
DB_USERNAME=myuser
DB_PASSWORD=mypassword
```

Нашиот проект е направен со SQLite, па не мора да се прават никакви конекции, само е потребна патеката кон SQLite фајлот.

## Работа со прашалници

Од кога ќе ја дефинирата конекцијата кон податочната база, ние ќе може да извршуваме прашалници т.е queries. Со помош на `DB` ние ќе може да работиме со `select`, `update`, `insert`, `delete`. Ова може да го сториме така што во некоја од нашите методи ќе го искоритиме `DB::тип`, за да може да го користиме ова прво ќе мора да го импортираме `use Illuminate\Support\Facades\DB;` 

Пример за SELECT: 

[62]

```php
use Illuminate\Support\Facades\DB;

$users = DB::select('select * from users');

$getUserById = DB::select('select * from users where id = :id', ['id' => 1]);
```

## Како работат миграциите во Laravel

Миграциите преставуват некаков тип на version control на нашата податочна база, тие ни овозоможуваат лесен и сигрен начин при дефиниција и споделување на шемите.

### Креирање на миграија

За да се креира една миграција ние ја пишуваме следнава команда во нашиот терминал: `php artisan make:migration create_name_table`. Фајлот ќе биде зачуван во `/database/migrations/`.

```php
php artisan make:migration create_name_table
```

### Структура на миграцијата

Доколку сакаме да додадеме нов атрибут во миграцијата тоа го правиме во `function up` така што го користиме параметарот $table->тип('име').

``` php
return new class extends Migration
{
    public function up(): void
    {
        Schema::create('post_votes', function (Blueprint $table) {
            $table->id();
            $table->timestamps();
        });
    }
    /**
     * Reverse the migrations.
     */
    public function down(): void
    {
        Schema::dropIfExists('post_votes');
    }
};
```

За да ја додадеме оваа шема во табелата ќе треба да напишеме:

```bash
php artisan migrate
``` 

Постојат многу типови на податоци кои може да ги искористите при креирање на миграција. Но јас ќе ги објаснам само тие што се наоѓаат во нашиот проект.

- Примарен клуч: под defult е `$table->id()` но доколку сакаме да го смениме, користиме `$table->primary('name')`, два или повеќе примарни клуча: `$table->primary(['primary1','primary2'],..)`
- Надворешен клуч: `$table->foreign('name')->references('attribute')->on('tableName');`
- Цел број: `$table->integer('name');`
- Булеан: `$table->boolean('name');`
- Текст: `$table->string('name');`
- Децимален број: `$table->float('name', 8, 2);`


| Команда                        | Опис                                                                                   |
| ------------------------------ | --------------------------------------------------------------------------------------------- |
| `php artisan migrate`          | Ќе ги мигрира само миграциите кои се во состојба pending.                                        |
| `php artisan migrate:fresh`    | Ги брише сите миграции и сите податоци од податчнат база така што го повикува down методот на секоја миграција како да сме направиле нова.         |
| `php artisan migrate:refresh`  | Ќе ги ресетира сите миграции и повторно ги креира така што прави drop на секоја табела. |
| `php artisan migrate:rollback` | Ќе ја негира последната миграција што сме ја направиле |

## Миграции од проектот

### create_posts_table

Оваа миграција е одговорна за креирање на табелата `posts` во податочната база.

- `id`: Примарен клуч
- `user_id`: Надворешен клуч кон табелата `users`, се користи за идентификација на корисникот кој го создал постот.
- `flair_id`: Надворешен клуч кон табелата `falir`, се користи за идентификација на флаерот кој го одбрал корисникот.
- `image_id`: Надворешен клуч кон табелата `images` и се користи за прикачување на слика за постот.
- `body`: Текстот на постот.
- `spoiler`: Булеан вредност која означува дали постот е спојлер или не.

### create_communities_table

Оваа миграција е одговорна за креирање на табелата `communities` во податочната база.

- `id`: Примарен клуч
- `user_id`: Надворешен клуч кон табелата `users`, се користи за идентификација на корисникот кој го создал community.
- `image_id`: Надворешен клуч кон табелата `images` и се користи за прикачување на слика за постот.
- `name`: Име на community, уникатно.
- `description`: Опис.
- `rules`: Текст кој ги пишува 

### create_images_table

Оваа миграција е одговорна за креирање на табелата `images` во подаочната база, се користи кога сакаме да зачуваме некоја слика.

- `id`: Примарен клуч
- `filename`: Име на сликата. 
- `path`: Релативна патека до Storage која може да се користи за да се пристапи до сликата.

### create_flairs_table

Оваа миграција е одговорна за креирање на табелата `images` во податочната база.

- `id`: Примарен клуч
- `community_id`: Надворешен клуч кон табелата `community`, се користи за да се ордеи на кој community припаѓа овој флаер.
- `name`: име на флаерот.

### create_post_votes и create_comment_votes

Овие миграција се одговорни за креирање на две табели, се користат за да се одреди на кој корисник „му се допаѓа“ (like) постот или коментарот и на кого „не му се допаѓа“(dislike). За comment е исто само што наместо `post_id`, имаме `community_id`.

- `post_id`, `user_id`: Примарен клуч
- `user_id`: Надворешен клуч кон табелата `users`
- `post_id`: Надворешен клуч кон табелата `posts` 
- `vote`: Булеан вредност со која одредуваме дали станува за like или dislike.

### create_follows_table

Оваа миграција е одговорна за креирање на `follows` таблеа, оваа табела се користи кога сакаме да знаеме кој корисник кој community го следи.

- `user_id`, `community_id`: Примарен клуч
- `user_id`: Надворешен клуч кон табелата `users` 

### create_comments_table

Оваа миграција е одговорна за креирање на `comments` таблеа, оваа табела се користи за чување на коментарите на еден пост, од кој корисник.

- `id`: Примарен клуч
- `user_id`: Надворешен клуч кон табелата `users`, ни кажува кој корисник го напишал коментарот.
- `post_id`: Надворешен клуч кон табелата `post_id`, одредува на кој пост 

### create_user_statuses_table

Оваа миграција е одговорна за креирање на `user_statuses` табела, оваа табела се користи кога сакаме да видиме дали корисникот е мометално активен или не.

- `id`: Примарен клуч
- `user_id`: Надворешен клуч кон табелата `users`.
- `active`: Булеан вредност, со која се одреудва дали корисникот е мометално активен или не.
- `activity`: Датум и време, кога корисникот последно бил најавен на нашата апликација.

### create_user_karmas_table

Оваа миграција е одговорна за креирање на `user_karmas` табелата, оваа табела има за цел да го ја чува кармата на корисникот.

- `id`: Примарен клуч
- `user_id`: Надворешен клуч кон табелата `users`.
- `karma`: Цел број, при лајк или дислајк се упдејтира оваа променлива.

### create_user_infos_table

Оваа миграција е одговорна за креирање на `user_infos` табела, оваа табела го чува описот и сликата на корисникот.

- `id`: Примарен клуч
- `user_id`: Надворешен клуч кон табелата `users`. Одредува за кој корисник станува збор.
- `bio`: Тескт поле во кое се чуваат дескрипцијата на корисникот.

### create_moderators_table

Оваа миграција е одговорна за креирање на `moderators` табела, оваа табела ги чува сите модератори на еден community. 

- `id`: Примарен клуч.
- `user_id`: Надворешен клуч кон табелата `users`. Одредува за кој корисник станува збор.
- `community_id`: За кој community станува збор. 



